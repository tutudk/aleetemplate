const LOCAL_STORAGE_WISHLIST_KEY="wishlist-list",LOCAL_STORAGE_DELIMITER=",",selectors={button:".btn--wishlist",grid:"[grid-wishlist]",productCard:".product-grid"};document.addEventListener("DOMContentLoaded",(()=>{initButtons(),initGrid();const t=getWishlist();$("[data-count-wishlist] .count").html(t.length)})),document.addEventListener("wishlist-list:updated",(t=>{initGrid()}));const fetchProductCardHTML=t=>fetch(`/products/${t}?view=wishlist`).then((t=>t.text())).then((t=>{const s=t;return(new DOMParser).parseFromString(s,"text/html").documentElement.querySelector(selectors.productCard).outerHTML})).catch((s=>console.error(`[Shopify Content] Failed to load content for handle: ${t}`,s))),setupGrid=async t=>{const s=getWishlist(),i=s.map(fetchProductCardHTML),e=(await Promise.all(i)).join("");t.innerHTML=e,initButtons(),ajaxCart.init();const l=new CustomEvent("wishlist-list:init-product-grid",{detail:{wishlist:s}});document.dispatchEvent(l),$(".wishlist-page__content").removeClass("loading"),s.length>0?$(".wishlist-empty").addClass("d-block"):$(".wishlist-empty").removeClass("d-none"),vela.swatchProduct()},setupButtons=t=>{t.forEach((t=>{const s=t.dataset.productHandle||!1;wishlistContains(s)&&t.classList.add("is-added"),t.addEventListener("click",(()=>{setTimeout((function(){t.classList.remove("is-adding");const s=document.querySelector(".spinner-border");null!=s&&s.remove(),t.classList.toggle("is-added"),$(t).hasClass("is-added")?(t.setAttribute("title",vela.strings.remove_wishlist),$(t).hasClass("show-tooltip")&&(t.querySelector(".tooltip-inner").innerHTML=vela.strings.remove_wishlist),$(t).hasClass("product-single__wishlist")&&(t.querySelector(".text").innerHTML=vela.strings.remove_wishlist)):(t.setAttribute("title",vela.strings.add_to_wishlist),$(t).hasClass("show-tooltip")&&(t.querySelector(".tooltip-inner").innerHTML=vela.strings.add_to_wishlist),$(t).hasClass("product-single__wishlist")&&(t.querySelector(".text").innerHTML=vela.strings.add_to_wishlist))}),1e3);const i=document.createElement("span");i.classList.add("spinner-border","spinner-border-sm"),updateWishlist(s),t.classList.add("is-adding"),t.appendChild(i)}))}))},initGrid=()=>{const t=document.querySelector(selectors.grid)||!1;t&&setupGrid(t)},initButtons=t=>{if(t){let s=document.querySelector(t).querySelectorAll(selectors.button)||[];if(!s.length)return;setupButtons(s)}else{const t=document.querySelectorAll(selectors.button)||[];if(!t.length)return;setupButtons(t)}const s=new CustomEvent("wishlist-list:init-buttons",{detail:{wishlist:getWishlist()}});document.dispatchEvent(s),$(selectors.button).each((function(t){$(this).hasClass("is-added")?($(this).attr("title",vela.strings.remove_wishlist),$(this).find(".text").html(vela.strings.remove_wishlist),$(this).hasClass("show-tooltip")&&$(this).find(".tooltip-inner").html(vela.strings.remove_wishlist),$(this).hasClass("product-single__wishlist")&&$(this).find(".text").html(vela.strings.remove_wishlist)):($(this).attr("title",vela.strings.add_to_wishlist),$(this).find(".text").html(vela.strings.add_to_wishlist),$(this).hasClass("show-tooltip")&&$(this).find(".tooltip-inner").html(vela.strings.add_to_wishlist),$(this).hasClass("show-tooltip")&&$(this).find(".text").html(vela.strings.add_to_wishlist))}))},getWishlist=()=>{const t=localStorage.getItem("wishlist-list")||!1;return t?t.split(","):[]},setWishlist=t=>{const s=t.join(",");t.length?localStorage.setItem("wishlist-list",s):localStorage.removeItem("wishlist-list");const i=new CustomEvent("wishlist-list:updated",{detail:{wishlist:t}});return document.dispatchEvent(i),s},updateWishlist=t=>{const s=getWishlist(),i=s.indexOf(t);return-1===i?s.push(t):s.splice(i,1),$("[data-count-wishlist] .count").html(s.length),setWishlist(s)},wishlistContains=t=>getWishlist().includes(t),resetWishlist=()=>setWishlist([]);